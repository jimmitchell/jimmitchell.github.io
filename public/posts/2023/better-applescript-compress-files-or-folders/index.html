<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Better Applescript Compress Files or Folders | Jim Mitchell</title>
<meta name=keywords content="AppleScript,Code"><meta name=description content="I created an AppleScript that allows you to compress files and folders by simply dropping them onto the applet. A reader asked for a way to archive files and folders based off that post. This was my solution."><meta name=author content="Jim Mitchell"><link rel=canonical href=http://localhost:1313/posts/2023/better-applescript-compress-files-or-folders/><link crossorigin=anonymous href=/assets/css/stylesheet.06d743ce86e1cf336cd13b9eae768ce9bf601941ed7f600729cd9def5e52d940.css integrity="sha256-BtdDzobhzzNs0TuernaM6b9gGUHtf2AHKc2d715S2UA=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/favicon/favicon.io><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/favicon/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/favicon/favicon-32x32.png><link rel=apple-touch-icon href=http://localhost:1313/favicon/apple-touch-icon.png><link rel=mask-icon href=http://localhost:1313/favicon/favicon-32x32.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/posts/2023/better-applescript-compress-files-or-folders/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Better Applescript Compress Files or Folders"><meta property="og:description" content="I created an AppleScript that allows you to compress files and folders by simply dropping them onto the applet. A reader asked for a way to archive files and folders based off that post. This was my solution."><meta property="og:type" content="article"><meta property="og:url" content="http://localhost:1313/posts/2023/better-applescript-compress-files-or-folders/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-04-14T20:56:54-07:00"><meta property="article:modified_time" content="2023-04-14T20:56:54-07:00"><meta property="og:site_name" content="Jim Mitchell"><meta name=twitter:card content="summary"><meta name=twitter:title content="Better Applescript Compress Files or Folders"><meta name=twitter:description content="I created an AppleScript that allows you to compress files and folders by simply dropping them onto the applet. A reader asked for a way to archive files and folders based off that post. This was my solution."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://localhost:1313/posts/"},{"@type":"ListItem","position":2,"name":"Better Applescript Compress Files or Folders","item":"http://localhost:1313/posts/2023/better-applescript-compress-files-or-folders/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Better Applescript Compress Files or Folders","name":"Better Applescript Compress Files or Folders","description":"I created an AppleScript that allows you to compress files and folders by simply dropping them onto the applet. A reader asked for a way to archive files and folders based off that post. This was my solution.","keywords":["AppleScript","Code"],"articleBody":"A while ago, I created an AppleScript that allows you to compress files and folders by simply dropping them onto the applet. One of the readers left a comment asking for a way to achieve the following tasks:\nSelect a folder from Finder. Store the folder name as “x”. Compress all files and sub-folders within the folder “x”, including their paths. Rename the resulting zip file as “x.zip”. Delete all the files that were used to create the zip file. With the help of ChatGPT – and because I wanted to be lazy about it – I was able to come up with a solution to this challenge, which can be a great way to manage archives if that’s important to you.\nI must admit that ChatGPT did a decent job in generating the AppleScript, but there were some bugs that I had to fix manually. Nevertheless, it’s both scary and exciting to have a tool that can generate usable code.\nAs always, you can run this script using FastScripts from your menu bar for quick and easy access.\n-- choose files or folders to archive since AppleScript can't seem to allow both at once... set archiveOption to button returned of (display dialog \"Archive files or folders?\" buttons {\"Cancel\", \"Folders\", \"Files\"} default button 3) -- now let's choose what we want to archive... if archiveOption is \"Files\" then set selectedItems to choose file with prompt \"Select files you want to compress:\" with multiple selections allowed else if archiveOption is \"Folders\" then set selectedItems to choose folder with prompt \"Select folders you want to compress:\" with multiple selections allowed else if archiveOption is \"Cancel\" then return end if -- set the array of files or folders selected... if the selectedItems is {} then return else if (selectedItems count) is equal to 1 then set thePathFilename to the quoted form of POSIX path of (selectedItems as string) else set thePathFilename to {} repeat with i from 1 to (selectedItems count) copy (quoted form of POSIX path of (item i of selectedItems as string)) \u0026 space to end of thePathFilename end repeat set thePathFilename to thePathFilename as string end if -- coerce a date string for the archive name set currentDate to current date set yearStr to year of currentDate as string set monthStr to (month of currentDate as integer) as string if length of monthStr = 1 then set monthStr to \"0\" \u0026 monthStr set dayStr to day of currentDate as string if length of dayStr = 1 then set dayStr to \"0\" \u0026 dayStr set currentDateStr to yearStr \u0026 \"-\" \u0026 monthStr \u0026 \"-\" \u0026 dayStr -- next, let's name our archive, which defaults to \"Archive\" \u0026 the currentDateStr we just coerced set archiveName to text returned of (display dialog \"Enter a name for your archive:\" default answer \"Archive \" \u0026 currentDateStr buttons {\"Cancel\", \"OK\"} default button 2) -- then, let's choose where to save the archive and compress it with the shell \"zip\" command set archiveFile to POSIX path of (choose folder with prompt \"Choose a location to save the archive:\") do shell script \"cd \" \u0026 quoted form of archiveFile \u0026 \" \u0026\u0026 zip -r \" \u0026 quoted form of archiveName \u0026 \".zip \" \u0026 thePathFilename -- finally, let's delete the files we just archived if we decide we don't need them around anymore. set deleteFiles to button returned of (display dialog \"Do you want to delete the original files?\" buttons {\"Yes\", \"No\"} default button 2) set deleteOption to false if deleteFiles is \"Yes\" then set deleteOption to true end if if deleteOption is equal to true then if selectedItems is not {} then set fileList to {} repeat with itemPath in selectedItems set end of fileList to quoted form of POSIX path of itemPath end repeat repeat with fileItem in fileList do shell script \"rm \" \u0026 fileItem end repeat end if end if ","wordCount":"646","inLanguage":"en","datePublished":"2023-04-14T20:56:54-07:00","dateModified":"2023-04-14T20:56:54-07:00","author":{"@type":"Person","name":"Jim Mitchell"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/posts/2023/better-applescript-compress-files-or-folders/"},"publisher":{"@type":"Organization","name":"Jim Mitchell","logo":{"@type":"ImageObject","url":"http://localhost:1313/favicon/favicon.io"}}}</script></head><body id=top><script>window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="Jim Mitchell (Alt + H)">Jim Mitchell</a><div class=logo-switches></div></div><ul id=menu><li><a href=http://localhost:1313/archives/ title=Archives><span>Archives</span></a></li><li><a href=http://localhost:1313/about/ title=About><span>About</span></a></li><li><a href=http://localhost:1313/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Better Applescript Compress Files or Folders</h1><div class=post-meta><span title='2023-04-14 20:56:54 -0700 PDT'>Friday, April 14, 2023</span>&nbsp;·&nbsp;4 min&nbsp;·&nbsp;646 words&nbsp;·&nbsp;Jim Mitchell</div></header><div class=post-content><p>A while ago, I created an AppleScript that allows you to compress files and folders by simply dropping them onto the applet. One of the readers left a comment asking for a way to achieve the following tasks:</p><blockquote><ol><li>Select a folder from Finder.</li><li>Store the folder name as “x”.</li><li>Compress all files and sub-folders within the folder “x”, including their paths.</li><li>Rename the resulting zip file as “x.zip”.</li><li>Delete all the files that were used to create the zip file.</li></ol></blockquote><p>With the help of ChatGPT – and because I wanted to be lazy about it – I was able to come up with a solution to this challenge, which can be a great way to manage archives if that’s important to you.</p><p>I must admit that ChatGPT did a decent job in generating the AppleScript, but there were some bugs that I had to fix manually. Nevertheless, it’s both scary and exciting to have a tool that can generate usable code.</p><p>As always, you can run this script using <a href=http://www.red-sweater.com/fastscripts/>FastScripts</a> from your menu bar for quick and easy access.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-applescript data-lang=applescript><span class=line><span class=cl><span class=c>-- choose files or folders to archive since AppleScript can&#39;t seem to allow both at once...</span>
</span></span><span class=line><span class=cl><span class=k>set</span> <span class=nv>archiveOption</span> <span class=k>to</span> <span class=na>button returned</span> <span class=k>of</span> <span class=p>(</span><span class=nb>display dialog</span> <span class=s2>&#34;Archive files or folders?&#34;</span> <span class=nb>buttons</span> <span class=p>{</span><span class=s2>&#34;Cancel&#34;</span><span class=p>,</span> <span class=s2>&#34;Folders&#34;</span><span class=p>,</span> <span class=s2>&#34;Files&#34;</span><span class=p>}</span> <span class=nv>default</span> <span class=nb>button</span> <span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>-- now let&#39;s choose what we want to archive...</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nv>archiveOption</span> <span class=ow>is</span> <span class=s2>&#34;Files&#34;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>	<span class=k>set</span> <span class=nv>selectedItems</span> <span class=k>to</span> <span class=nb>choose file</span> <span class=k>with</span> <span class=na>prompt</span> <span class=s2>&#34;Select files you want to compress:&#34;</span> <span class=k>with</span> <span class=nv>multiple</span> <span class=nv>selections</span> <span class=nv>allowed</span>
</span></span><span class=line><span class=cl><span class=k>else</span> <span class=k>if</span> <span class=nv>archiveOption</span> <span class=ow>is</span> <span class=s2>&#34;Folders&#34;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>	<span class=k>set</span> <span class=nv>selectedItems</span> <span class=k>to</span> <span class=nb>choose folder</span> <span class=k>with</span> <span class=na>prompt</span> <span class=s2>&#34;Select folders you want to compress:&#34;</span> <span class=k>with</span> <span class=nv>multiple</span> <span class=nv>selections</span> <span class=nv>allowed</span>
</span></span><span class=line><span class=cl><span class=k>else</span> <span class=k>if</span> <span class=nv>archiveOption</span> <span class=ow>is</span> <span class=s2>&#34;Cancel&#34;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>	<span class=no>return</span>
</span></span><span class=line><span class=cl><span class=k>end</span> <span class=k>if</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>-- set the array of files or folders selected...</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nb>the</span> <span class=nv>selectedItems</span> <span class=ow>is</span> <span class=p>{}</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>	<span class=no>return</span>
</span></span><span class=line><span class=cl><span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=nv>selectedItems</span> <span class=nb>count</span><span class=p>)</span> <span class=ow>is equal</span> <span class=k>to</span> <span class=mi>1</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>	<span class=k>set</span> <span class=nv>thePathFilename</span> <span class=k>to</span> <span class=nb>the</span> <span class=nb>quoted form</span> <span class=k>of</span> <span class=nv>POSIX</span> <span class=na>path</span> <span class=k>of</span> <span class=p>(</span><span class=nv>selectedItems</span> <span class=k>as </span><span class=nc>string</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>else</span>
</span></span><span class=line><span class=cl>	<span class=k>set</span> <span class=nv>thePathFilename</span> <span class=k>to</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>	<span class=k>repeat</span> <span class=k>with</span> <span class=nv>i</span> <span class=k>from</span> <span class=mi>1</span> <span class=k>to</span> <span class=p>(</span><span class=nv>selectedItems</span> <span class=nb>count</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=nb>copy</span> <span class=p>(</span><span class=nb>quoted form</span> <span class=k>of</span> <span class=nv>POSIX</span> <span class=na>path</span> <span class=k>of</span> <span class=p>(</span><span class=nb>item</span> <span class=nv>i</span> <span class=k>of</span> <span class=nv>selectedItems</span> <span class=k>as </span><span class=nc>string</span><span class=p>))</span> <span class=o>&amp;</span> <span class=no>space</span> <span class=k>to</span> <span class=k>end</span> <span class=k>of</span> <span class=nv>thePathFilename</span>
</span></span><span class=line><span class=cl>	<span class=k>end</span> <span class=k>repeat</span>
</span></span><span class=line><span class=cl>	<span class=k>set</span> <span class=nv>thePathFilename</span> <span class=k>to</span> <span class=nv>thePathFilename</span> <span class=k>as </span><span class=nc>string</span>
</span></span><span class=line><span class=cl><span class=k>end</span> <span class=k>if</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>-- coerce a date string for the archive name</span>
</span></span><span class=line><span class=cl><span class=k>set</span> <span class=nv>currentDate</span> <span class=k>to</span> <span class=nb>current date</span>
</span></span><span class=line><span class=cl><span class=k>set</span> <span class=nv>yearStr</span> <span class=k>to</span> <span class=nb>year</span> <span class=k>of</span> <span class=nv>currentDate</span> <span class=k>as </span><span class=nc>string</span>
</span></span><span class=line><span class=cl><span class=k>set</span> <span class=nv>monthStr</span> <span class=k>to</span> <span class=p>(</span><span class=nb>month</span> <span class=k>of</span> <span class=nv>currentDate</span> <span class=k>as</span> <span class=nv>integer</span><span class=p>)</span> <span class=k>as </span><span class=nc>string</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nv>length</span> <span class=k>of</span> <span class=nv>monthStr</span> <span class=o>=</span> <span class=mi>1</span> <span class=k>then</span> <span class=k>set</span> <span class=nv>monthStr</span> <span class=k>to</span> <span class=s2>&#34;0&#34;</span> <span class=o>&amp;</span> <span class=nv>monthStr</span>
</span></span><span class=line><span class=cl><span class=k>set</span> <span class=nv>dayStr</span> <span class=k>to</span> <span class=nb>day</span> <span class=k>of</span> <span class=nv>currentDate</span> <span class=k>as </span><span class=nc>string</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nv>length</span> <span class=k>of</span> <span class=nv>dayStr</span> <span class=o>=</span> <span class=mi>1</span> <span class=k>then</span> <span class=k>set</span> <span class=nv>dayStr</span> <span class=k>to</span> <span class=s2>&#34;0&#34;</span> <span class=o>&amp;</span> <span class=nv>dayStr</span>
</span></span><span class=line><span class=cl><span class=k>set</span> <span class=nv>currentDateStr</span> <span class=k>to</span> <span class=nv>yearStr</span> <span class=o>&amp;</span> <span class=s2>&#34;-&#34;</span> <span class=o>&amp;</span> <span class=nv>monthStr</span> <span class=o>&amp;</span> <span class=s2>&#34;-&#34;</span> <span class=o>&amp;</span> <span class=nv>dayStr</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>-- next, let&#39;s name our archive, which defaults to &#34;Archive&#34; &amp; the currentDateStr we just coerced</span>
</span></span><span class=line><span class=cl><span class=k>set</span> <span class=nv>archiveName</span> <span class=k>to</span> <span class=na>text returned</span> <span class=k>of</span> <span class=p>(</span><span class=nb>display dialog</span> <span class=s2>&#34;Enter a name for your archive:&#34;</span> <span class=nv>default</span> <span class=nv>answer</span> <span class=s2>&#34;Archive &#34;</span> <span class=o>&amp;</span> <span class=nv>currentDateStr</span> <span class=nb>buttons</span> <span class=p>{</span><span class=s2>&#34;Cancel&#34;</span><span class=p>,</span> <span class=s2>&#34;OK&#34;</span><span class=p>}</span> <span class=nv>default</span> <span class=nb>button</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>-- then, let&#39;s choose where to save the archive and compress it with the shell &#34;zip&#34; command</span>
</span></span><span class=line><span class=cl><span class=k>set</span> <span class=nv>archiveFile</span> <span class=k>to</span> <span class=nv>POSIX</span> <span class=na>path</span> <span class=k>of</span> <span class=p>(</span><span class=nb>choose folder</span> <span class=k>with</span> <span class=na>prompt</span> <span class=s2>&#34;Choose a location to save the archive:&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>do shell script</span> <span class=s2>&#34;cd &#34;</span> <span class=o>&amp;</span> <span class=nb>quoted form</span> <span class=k>of</span> <span class=nv>archiveFile</span> <span class=o>&amp;</span> <span class=s2>&#34; &amp;&amp; zip -r &#34;</span> <span class=o>&amp;</span> <span class=nb>quoted form</span> <span class=k>of</span> <span class=nv>archiveName</span> <span class=o>&amp;</span> <span class=s2>&#34;.zip &#34;</span> <span class=o>&amp;</span> <span class=nv>thePathFilename</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>-- finally, let&#39;s delete the files we just archived if we decide we don&#39;t need them around anymore.</span>
</span></span><span class=line><span class=cl><span class=k>set</span> <span class=nv>deleteFiles</span> <span class=k>to</span> <span class=na>button returned</span> <span class=k>of</span> <span class=p>(</span><span class=nb>display dialog</span> <span class=s2>&#34;Do you want to delete the original files?&#34;</span> <span class=nb>buttons</span> <span class=p>{</span><span class=s2>&#34;Yes&#34;</span><span class=p>,</span> <span class=s2>&#34;No&#34;</span><span class=p>}</span> <span class=nv>default</span> <span class=nb>button</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>set</span> <span class=nv>deleteOption</span> <span class=k>to</span> <span class=no>false</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nv>deleteFiles</span> <span class=ow>is</span> <span class=s2>&#34;Yes&#34;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>	<span class=k>set</span> <span class=nv>deleteOption</span> <span class=k>to</span> <span class=no>true</span>
</span></span><span class=line><span class=cl><span class=k>end</span> <span class=k>if</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nv>deleteOption</span> <span class=ow>is equal</span> <span class=k>to</span> <span class=no>true</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=nv>selectedItems</span> <span class=ow>is not</span> <span class=p>{}</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>		<span class=k>set</span> <span class=nv>fileList</span> <span class=k>to</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>		<span class=k>repeat</span> <span class=k>with</span> <span class=nv>itemPath</span> <span class=k>in</span> <span class=nv>selectedItems</span>
</span></span><span class=line><span class=cl>			<span class=k>set</span> <span class=k>end</span> <span class=k>of</span> <span class=nv>fileList</span> <span class=k>to</span> <span class=nb>quoted form</span> <span class=k>of</span> <span class=nv>POSIX</span> <span class=na>path</span> <span class=k>of</span> <span class=nv>itemPath</span>
</span></span><span class=line><span class=cl>		<span class=k>end</span> <span class=k>repeat</span>
</span></span><span class=line><span class=cl>		
</span></span><span class=line><span class=cl>		<span class=k>repeat</span> <span class=k>with</span> <span class=nv>fileItem</span> <span class=k>in</span> <span class=nv>fileList</span>
</span></span><span class=line><span class=cl>			<span class=nb>do shell script</span> <span class=s2>&#34;rm &#34;</span> <span class=o>&amp;</span> <span class=nv>fileItem</span>
</span></span><span class=line><span class=cl>		<span class=k>end</span> <span class=k>repeat</span>
</span></span><span class=line><span class=cl>	<span class=k>end</span> <span class=k>if</span>
</span></span><span class=line><span class=cl><span class=k>end</span> <span class=k>if</span>
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:1313/tags/applescript/>AppleScript</a></li><li><a href=http://localhost:1313/tags/code/>Code</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2024 <a href=http://localhost:1313/>Jim Mitchell</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>